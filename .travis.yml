env:
 global:
   - secure: "Hgx85wfMDWFniV2oqcFZMj2yfFbdPFMoFXU6ZGzrJYFHZg8MTjp1Mh+w/6wQfqGneJmogfUTcC3kv1mqB34Hg5Jozw9BKe9pc/a+LtqoiBoNpnF070m1ujDYT7sF4/LR5Qzuqe10fMHa/F9H59dhI1duYrNeA4N/i+OjljBjpQ5DANNoTQH7ayeiSIvuoGYzQ6JtlZfIKg6DdzC9Ixcg+q90+UIyZ41eGY7/kcNX+krR5cfUjvbROBYbY4vAjFeSsPdLZ+fcU/GwsZlls8oV8lEMIAAuf4uRtaffzBDsXbey6/OAjVayqgoTyuWYil4zMs32rDTHoqt74nwjPgToyua9d1MefI9LVX0CHwQQ6ThRDHuP79EuQBU296GHcuYS8makqTeMO2iNMirUhDAsHYakRYxpnABrlCNYJjB+cLrMAKF/VjzeXQDsVEg+JLJFUrq3XGfw/Jt9djOmUAIUzZbVtumYqQy8aKmzuFtR4lhx85NAwq7tgxfFYogCq1wjt5H8E0jdjKXNfK+2MxohGp2rBIiv3CtQZPk/K7ZVGYIEB+ca6wm4/gfyzvyv2dcQUpJsl92ec2SUA2+ZBQTzkftRTbOhbppxwmGpXkoiQd763qL8b0tJcHDSELzIsF4YhkwXr9ZgUTatbH02KpVEtxav+jqxsx8/WRDu7Wtw+eI="
   - secure: "S2jYQTIN7hBIPIfRERx/M8lATbyO9HTd4lVn9FJhchOXeJDlgMy7u1iRjms6KSZ1sTuhSZdHzdL64jPI7zITFTiaQEbpCqg1nllj4u0MPl6aupDjMaaddHhePz3PjjLDrOpDOk8/y+BCh3EIbrFwNsDLNGvAfkOTP6RWMwqmr2KaVpYbQQHapumdYB94Qs7MiOrw76G+XwNnTMa38T0j09M3JoQ8MXiVkyzqSqxBs6etFmgGjWRFw/tjEmx3qYFyqBDK5LsEzuuDxfwNeGshAmMKTWFV95Amjr6dNrUsuDERRZFzimJhilGDAXgy16Sso5E0k+1hrT39CPnQTpIDx4Qwgja33i6Z3B9ihiaAEuNVJdgXOp9n2iWZo/1pXcFlpqSAI11EhT4Upfn9uCBVq3Aq4Di6ram2r6lDJGxVSM7x/VTI3ylibEfU6xZ9iQb4dLRoWmyUyku3iYf7MEHeU7cAJQptdB18d0744MF6MOMvuWujHOehQ3x+WOi6OxAQDQvc7V5DQ+LDaAvtF5htAYI5PZrfMs8rEBL2MWLTt9OTZ1bWkWoK8bWXI7P41qvJUGf1muwG9xcwnkkjHJG1crDzr5Tc4r/SAH2b9QbWsaMAnDX2+s2V2lI1umo/gzJnIL2rfBWr+WkoirYZIyqWE0TCncvDe8SD9exPlcFE4HY="
   - secure: "YIeWwkPns4BoUYxn59N3+Qg/84v+5756D9wgQ3EwRzLe2j+iRrkUSiKLeC5ynxQDAsybaNhZ4qky22hdfbsQPaLqEZ2I6QW82fM88r0/or310uSJKujAS/eXQeUI+X3KziN6fDjlfueH+M8vvzs0zyJqW9Bbr397rhI6TluGnKisKsTfvthZwP3uys0iYdF7TbrRsdqwoilHFEUPDEVgIP37V6r1IMTzmecD7Jk49FwrIcgKlDpFCwjHLKZQbkgqObkJAYlFbFzmrL/4DB7kr7jpVjuhj6rmSDZnBB5D2kcLGOHZRgFBPiBPuNpZaRPUddpihMEX+0eweh2AcJ0VdjZDQ3kZgODEkzkHiJFZgOEUOc4Y/8DrF2wknIfzTHfx8JZRnpBi5sFaSxE6FjYW6KtPWln5HPhldI2sd/3oCX8mzFcBhtggfBPmw4O0ewTrcicTvNhK/IG71hiwK0bEZxWvVDa8wbvHcsJ92uItV+inftNw84sb0qKFmUXzBK1YfX7bi+0g7GYB+pxwSiXhHoUPxDI6qHf9o5TxskrO27nSaJJpywWE/R0J89N8RJqIFfv/8cbHkl5JfP70H/hcOvUetSV/UENCmIB26g23yAPCHC1bT3B486PiurgM4YmXBs1O8vJlciFYOQQiQQGtQWtMqhHIIHpu+reNyumQkCU="
   - secure: "AnvgTjoc+0g7BTy4izir3+2p5oYkH8XNZPcjwlT5qLQGMdJQeTLt/ry0O6IUYfhjvTA2uxTn8KLK8kP/0Pgxq4Ob3EMD9MRMriTvWXh8Gt1RQktS6mau3mSBdfzyRAsq1HXDO6ntXtKe/zr8cpsLP8RAiGzqTFWNvZ7Ns6P09lmm8fUKbCloI4JtabjogFd6z6J+K2rnL0OMaJgfIRE4bXIhg1HXRKgyTfWwbGmlk7NpS1Ww78IORwvtsZT7YkH+sK9sVKHai1ceon/52QgKYGqdYdyFxth7Gup8JNV4my0anlBIXvfCXGI4UPHvsYvR6wd9nKc5fbuBIAdHnxSjITIShWxcc1bmAb3OjW3OOEddxFpEsskhw1S2YjPf2mGBlVo47y8YeBVbSZf/6rcN7ZK/iAc1FruS7TATtTMzDgrGXYpy6yWB0L0/80H/SK/pf39By1sBCMF9iftxN3uh/aCDCt52JQq/8cRTOZKKMqV45FsSr5b8gRSVSzVKd+SVSKj7UR2CTZ1VY9WntfpOszqjflbpkT/FhzFYK+sP3LuXL2em5Lzp8CmwmyM4t2WtMlrhtmqgMzS/USZez+dgWliz3z5B2Xal9TOx4Cicc0N6NuKF0LC1XM721Ug5c00p2lJN+HDy8WHz/hERl0x7CS0kM2/lFlwpnoPgxpWpG7I="

os:
  - linux

language: minimal

services:
  - docker

before_install:
  - echo "$DOCKERHUB_PWD" | docker login --username "$DOCKERHUB_USR" --password-stdin
  - echo "$REDHAT_PWD" | docker login --username "$REDHAT_USR" --password-stdin registry.redhat.io

install:
  - docker build --file d.jboss.Dockerfile --tag juliaaano/rhpam-jboss:latest .
  # - docker build --file d.springboot.Dockerfile --tag juliaaano/rhpam-springboot:latest .

before_script:
  - docker-compose up -d --force-recreate rhpam-jboss # rhpam-springboot
  - sleep 90

script:
  - POSTMAN_ENV=rhpam-container-jboss docker-compose run --rm postman
  # - POSTMAN_ENV=rhpam-springboot docker-compose run --rm postman

after_success:
  - for i in $(docker images --format "{{.Repository}}:{{.Tag}}" | grep "juliaaano"); do docker push $i; done
  - docker logout registry.redhat.io
  - docker logout
